---
title: "Trust in Artificial Intelligent Agents Scale"
description: |
  First quantitative approbation. Data analysis workflow
author:
  - name: Anton Angelgardt 
    url: https://www.hse.ru/en/staff/angelgardt
    affiliation: HSE University
    affiliation_url: https://www.hse.ru/en/
date: "`r Sys.Date()`"
output: radix::radix_article
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, cache = FALSE)
```


# Preprocess

Find preprocess workflow [here](https://angelgardt.github.io/taia/taia_preprocess.html).



# Packages

```{r}
library(tidyverse)
library(psych)
library(lavaan)
library(semPlot)
library(knitr)
library(corrplot)
```

```{r}
theme_set(theme_bw())
```

```{r echo=FALSE}
# load("taia_analysis.RData")
# save.image("taia_analysis.Rdata")
```


# Import data

```{r}
taia <- read_csv("https://github.com/angelgardt/taia/raw/master/data/taia.csv")
str(taia)
```





# Preparation

Vectors of TAIA items:

```{r}
pr_items <- colnames(taia)[8:17]
co_items <- colnames(taia)[18:27]
ut_items <- colnames(taia)[28:39]
fa_items <- colnames(taia)[40:49]
de_items <- colnames(taia)[50:60]
un_items <- colnames(taia)[61:72]
taia_items <- colnames(taia)[8:72]
```

Vector of GT items:

```{r}
gt_items <- colnames(taia)[73:78]
```

Column names for further formatting:

```{r}
col_names <- c("", "Num. of obs.", "Mean", "SD",
               "Median", "Trimmed Mean", "MAD",
               "Min", "Max", "Range",
               "Skewness", "Kurtuosis", "SE")
total_colnames <- c("Alpha", "Standardized Alpha", "Guttman's Lambda 6",
                    "Average interitem correlation", "S/N",
                    "Alpha SE", "Scale Mean", "Total Score SD",
                    "Median interitem correlation")
item_stats_colnames <- c("Num. of Obs.", "Discrimination",
                         "Std Cor",
                         "Cor Overlap Corrected",
                         "Cor if drop",
                         "Difficulty", "SD")
alpha_drop_colnames <- c("Alpha", "Standardized Alpha",
                "Guttman's Lambda 6",	"Average interitem correlation",
                "S/N",	"Alpha SE",	"Var(r)","Median interitem correlation")
```




# Exploratory analysis

## TAIA descriptive statistics


```{r}
taia %>% 
  select(all_of(pr_items)) %>% 
  describe() %>% 
  kable(caption = "Predictability", label = 1, digits = 2, col.names = col_names)
```

```{r}
taia %>% select(all_of(pr_items)) %>% 
  pivot_longer(cols = all_of(pr_items)) %>% 
  ggplot(aes(value)) +
  geom_bar(fill = "darkred") +
  facet_wrap(~ name) +
  scale_x_discrete(limits = 0:5) +
  labs(x = "Score", y = "Number of observations",
       title = "Predictability") +
  theme(plot.title = element_text(hjust = .5))
```

* `pr01` OK
  - Я считаю, что интеллектуальные системы надежны
* `pr02` OK
  - Я считаю, что результаты работы интеллектуальных систем хорошо предсказуемы
* `pr03` OK
  - Я считаю, что интеллектуальные системы ненадежны (R)
* `pr04` OK
  - Я считаю, что результаты работы интеллектуальных систем невозможно предсказать (R)
* `pr05` positive skewness
  - Я считаю, что поездки в машине, управляемой искусственным интеллектом, безопаснее, чем в обычной
* `pr06` OK
  - Я считаю, что медицинская диагностика с применением интеллектуальных систем надеждее, чем без них
* `pr07` OK
  - Я считаю, что финансовые операции под контролем искусственного интеллекта безопаснее, чем обычные
* `pr08` high kurtosis
  - Я считаю, что интеллектуальные системы, обеспечивающие безопасность домов, хорошо справляются со своей задачей
* `pr09` high kurtosis
  - Я считаю, что рекомендательные системы чаще всего правильно определяют предпочтения пользователей
* `pr10` OK



```{r}
taia %>% 
  select(all_of(co_items)) %>% 
  describe() %>% 
  kable(caption = "Consistency", label = 2, digits = 2, col.names = col_names)
```

```{r}
taia %>% select(all_of(co_items)) %>% 
  pivot_longer(cols = all_of(co_items)) %>% 
  ggplot(aes(value)) +
  geom_bar(fill = "chocolate3") +
  facet_wrap(~ name) +
  scale_x_discrete(limits = 0:5) +
  labs(x = "Score", y = "Number of observations",
       title = "Consistency") +
  theme(plot.title = element_text(hjust = .5))
```

* `co01` OK
  - Интеллектуальные системы надежны, так как те системы, с которыми я сталкивался (сталкивалась), были надежными
* `co02` OK
  - Я считаю, что если система при тестировании работает корректно, то и дальше она будет работать корректно
* `co03` high kurtosis
  - Я считаю, что интеллектуальные системы совершают меньше технических ошибок, чем люди
* `co04` high negative skewness
  - Со временем любая интеллектуальная система будет совершать всё меньше ошибок
* `co05` positive skewness
  - Если интеллектуальные системы, с которыми я сталкивался (сталкивалась), были надежными, то я могу считать надёжными другие системы
* `co06` positive skewness
  - Я могу судить о надёжности новой интеллектуальной системы по опыту работы с другими системами
* `co07` high positive skewness
  - Я могу сказать, что система работает корректно, только протестировав её (R)
* `co08` positive skewness
  - Если одна интеллектуальная система подводит меня, то и с другими будет то же самое
* `co09`positive skewness
  - Если одна интеллектуальная система соответствует моим ожиданиям, то с другими будет то же самое
* `co10` positive skewness
  - Я могу сформировать ожидания относительно работы интеллектуальных систем в целом на основе опыта взаимодействия с одной системой



```{r}
taia %>% 
  select(all_of(ut_items)) %>% 
  describe() %>% 
  kable(caption = "Utility", label = 3, digits = 2, col.names = col_names)
```

```{r}
taia %>% select(all_of(ut_items)) %>% 
  pivot_longer(cols = all_of(ut_items)) %>% 
  ggplot(aes(value)) +
  geom_bar(fill = "goldenrod3") +
  facet_wrap(~ name) +
  scale_x_discrete(limits = 0:5) +
  labs(x = "Score", y = "Number of observations",
       title = "Utility") +
  theme(plot.title = element_text(hjust = .5))
```

* `ut01` extremely high negative skewness
  - Я считаю, что интеллектуальные технологии — неотъемлемая часть развития общества
* `ut02` high negative skewness
  - Я считаю, что человечество нуждается в интеллектуальных системах
* `ut03` high negative skewness
  - Мне кажется, человечеству будет лучше без интеллектуальных систем (R)
* `ut04` negative skewness
  - Я считаю, что развитие интеллектуальных систем — это оправданный риск для общества
* `ut05` OK
  - По моему мнению, без интеллектуальных систем общественный прогресс остановился бы
* `ut06` negative skewness
  - Я считаю, что интеллектуальные системы существенно повышают качество медицинской диагностики
* `ut07` light negative skewness
  - Мне кажется, что оформить услуги с цифровыми помощниками гораздо проще, чем без них
* `ut08` negative skewness
  - Мне кажется, рекомендательные сервисы существенно сокращают время поиска нужной информации
* `ut09` negative skewness
  - Я считаю, что если полиция будет использовать интеллектуальные системы, то количество раскрытых преступлений увеличится
* `ut10` positive skewness
  - Мне кажется, при оформлении услуг через интернет можно справиться и без цифровых помощников (R)
* `ut11` OK
  - Я считаю, что если на дорогах появятся машины, управляемые искусственным интеллектом, то число аварий снизится
* `ut12` negative skewness
  - Я считаю, что использование интеллектуальных систем в обучении повышает качество образования



```{r}
taia %>% 
  select(all_of(fa_items)) %>% 
  describe() %>% 
  kable(caption = "Faith", label = 4, digits = 2, col.names = col_names)
```

```{r}
taia %>% select(all_of(fa_items)) %>% 
  pivot_longer(cols = all_of(fa_items)) %>% 
  ggplot(aes(value)) +
  geom_bar(fill = "darkgreen") +
  facet_wrap(~ name) +
  scale_x_discrete(limits = 0:5) +
  labs(x = "Score", y = "Number of observations",
       title = "Faith") +
  theme(plot.title = element_text(hjust = .5))
```

* `fa01` OK
  - Я готов (готова) довериться интеллектуальным системам, даже если я не до конца понимаю, как они работают
* `fa02` light positive skewness
  - Чтобы доверять интеллектуальной системе, мне нужно точно понимать, как работают её алгоритмы (R)
* `fa03` hard positive skewness
  - Если интеллектуальная система перестает реагировать на запросы, мне с этим комфортно
* `fa04` hard positive skewness
  - Если интеллектуальная система управлениями финансами не реагирует на запросы, я все равно буду уверен, что она работает корректно
* `fa05` OK
  - Я готов (готова) доверять результатам работы интеллектуальных систем, даже если я не знаю, как они работают
* `fa06` OK
  - Я готов (готова) довериться работе интеллектуальных систем так же, как работе профессионалов
* `fa07` OK
  - Я предпочту сам (сама) контролировать весь процесс нежели дам контроль интеллектуальной системе (R)
* `fa08` light positive skewness
  - Мне нужно знать детали работы алгоритма, чтобы быть уверенным (уверенной) в качестве результата его работы (R)
* `fa09` OK
  - Если я не понимаю, как работает интеллектуальная система, я не могу быть уверенным (уверенной) в результате её работы (R)
* `fa10` OK
  - Мне не важно, как работает интеллектуальная система, если она должным образом справляется со своей задачей



```{r}
taia %>% 
  select(all_of(de_items)) %>% 
  describe() %>% 
  kable(caption = "Dependability", label = 5, digits = 2, col.names = col_names)
```

```{r}
taia %>% select(all_of(de_items)) %>% 
  pivot_longer(cols = all_of(de_items)) %>% 
  ggplot(aes(value)) +
  geom_bar(fill = "darkblue") +
  facet_wrap(~ name) +
  scale_x_discrete(limits = 0:5) +
  labs(x = "Score", y = "Number of observations",
       title = "Dependability") +
  theme(plot.title = element_text(hjust = .5))
```

* `de01` negative skewness
  - Я готов (готова) следовать рекомендациям рекомендательных систем социальных сетей
* `de02` OK
  - Я готов (готова) делегировать управление финансами интеллектуальному помощнику
* `de03` OK
  - Если интеллектуальная система запрашивает мои личные данные, я могу быть уверен (уверенна) в их сохранности
* `de04` hard positive skewness
  - Я могу доверять интеллектуальной системе, если я точно понимаю, какие опасности исходят от неё
* `de05` hard negative skewness
  - Я бы мог (могла) жить в «умном доме»
* `de06` negative kurtosis
  - Если бы я ехал (ехала) в автомобиле, управляемом искусственным интеллектом, я бы был спокоен за свою безопасность
* `de07` OK
  - Если меня обследуют с помощью интеллектуальных медицинских технологий, я могу доверять выставленному диагнозу
* `de08` OK
  - Я считаю, что при покупках с интеллектуальными помощниками риск ошибиться меньше, чем без них
* `de09` negative skewness
  - Мне было бы некомфортно жить в «умном доме» (R)
* `de10` negative kurtosis
  - Я могу доверить искусственному интеллекту задачи, от которых зависит моя личная безопасность
* `de11` negative kurtosis
  - Я могу доверить искусственному интеллекту только рутинные задачи (например, уборка) (R)



```{r}
taia %>%
  select(all_of(un_items)) %>% 
  describe() %>% 
  kable(caption = "Understanding", label = 6, digits = 2, col.names = col_names)
```

```{r}
taia %>% select(all_of(un_items)) %>% 
  pivot_longer(cols = all_of(un_items)) %>% 
  ggplot(aes(value)) +
  geom_bar(fill = "purple4") +
  facet_wrap(~ name) +
  scale_x_discrete(limits = 0:5) +
  labs(x = "Score", y = "Number of observations",
       title = "Understanding") +
  theme(plot.title = element_text(hjust = .5))
```

* `un01` OK
  - Я понимаю, как происходит взаимодействие человека с интеллектуальными системами
* `un02` OK
  - Я понимаю, как работают алгоритмы интеллектуальных систем
* `un03` negative skewness
  - Я стараюсь разобраться в том, как работают интеллектуальные системы
* `un04` negative skewness
  - Я понимаю, как работают отдельные элементы интеллектуальных систем
* `un05` positive kurtosis
  - Я понимаю общий принцип работы интеллектуальных систем
* `un06` negative kurtosis
  - Я плохо разбираюсь в тонкостях работы интеллектуальных систем (R)
* `un07` negative kurtosis
  - Мне понятно, как работают интеллектуальные алгоритмы, применяемые в медицинской диагностике
* `un08` OK
  - Мне понятно, как работают алгоритмы рекомендательных систем социальных сетей
* `un09` extra negative kurtosis
  - Я понимаю, как работают алгоритмы автомобилей, управляемых искусственным интеллектом
* `un10` negative kurtosis
  - Я понимаю, как работают алгоритмы интеллектуальных систем, которые управляют финансами
* `un11` OK
  - Мне понятно, как устроены алгоритмы машинного перевода текстов
* `un12` OK
  - Мне понятно, как работают алгоритмы систем типа «умный дом»




### Correlations


#### Predictability

```{r}
corrplot.mixed(cor(taia %>% select(all_of(pr_items))),
               lower.col = "black")
```

#### Consistency

```{r}
corrplot.mixed(cor(taia %>% select(all_of(co_items))),
               lower.col = "black")
```


#### Utility

```{r}
corrplot.mixed(cor(taia %>% select(all_of(ut_items))),
               lower.col = "black")
```


#### Faith

```{r}
corrplot.mixed(cor(taia %>% select(all_of(fa_items))),
               lower.col = "black")
```


#### Dependability

```{r}
corrplot.mixed(cor(taia %>% select(all_of(de_items))),
               lower.col = "black")
```

#### Understanding

```{r}
corrplot.mixed(cor(taia %>% select(all_of(un_items))),
               lower.col = "black")
```


### All TAIA items correlations

```{r}
qgraph::qgraph(
  cor(taia %>% select(all_of(taia_items))),
  layout = "spring",
  posCol = "darkgreen",
  negCol = "darkred"
)
```






## Psychometric Analysis

### Subscales

#### Predictability

```{r}
pr1 <- psych::alpha(
  taia %>% select(all_of(pr_items)),
  cumulative = TRUE,
  title = "Predictability Factor",
  check.keys = FALSE
)
```

```{r}
kable(pr1$total,
      caption = "Perdictability. Subscale statistics", 
      label = 7, digits = 2,
      col.names = total_colnames
      )
```

```{r}
pr1$item.stats$mean <- pr1$item.stats$mean / 5
kable(pr1$item.stats,
      caption = "Predictability. Items statistics",
      label = 8, digits = 2,
      col.names = item_stats_colnames)
```

```{r}
pr1$item.stats %>%
  ggplot(aes(x = row.names(pr1$item.stats))) +
  geom_point(aes(y = mean), color = "darkblue", size = 3) +
  geom_point(aes(y = raw.r), color = "darkred", size = 2) +
  geom_hline(yintercept = 0.1, color = "darkblue") +
  geom_hline(yintercept = 0.9, color = "darkblue") +
  geom_hline(yintercept = 0.25, color = "darkred") +
  geom_hline(yintercept = 0, color = "black") +
  labs(x = "Item", y = "Value",
       title = "Predictability. Items characteristics",
       subtitle = "Difficulty (blue) and Dicrimination (red)") +
  theme(plot.title = element_text(hjust = .5),
        plot.subtitle = element_text(hjust = .5))
```

```{r}
kable(pr1$alpha.drop,
      caption = "Predictability. Subscale statistics when item drop",
      label = 9, digits = 2, col.names = alpha_drop_colnames)
```


```{r}
kable(pr1$response.freq,
      caption = "Predictability. Non missing response frequency for each item",
      label = 10, digits = 2)
```



#### Consistency

```{r}
co1 <- psych::alpha(
  taia %>% select(all_of(co_items)),
  cumulative = TRUE,
  title = "Consistency Factor",
  check.keys = FALSE
)
```

```{r}
kable(co1$total,
      caption = "Consistency. Subscale statistics", 
      label = 11, digits = 2,
      col.names = total_colnames)
```


```{r}
co1$item.stats$mean <- co1$item.stats$mean / 5
kable(co1$item.stats,
      caption = "Consistency. Items statistics",
      label = 12, digits = 2,
      col.names = item_stats_colnames)
```

```{r}
co1$item.stats %>%
  ggplot(aes(x = row.names(co1$item.stats))) +
  geom_point(aes(y = mean), color = "darkblue", size = 3) +
  geom_point(aes(y = raw.r), color = "darkred", size = 2) +
  geom_hline(yintercept = 0.1, color = "darkblue") +
  geom_hline(yintercept = 0.9, color = "darkblue") +
  geom_hline(yintercept = 0.25, color = "darkred") +
  geom_hline(yintercept = 0, color = "black") +
  labs(x = "Item", y = "Value",
       title = "Consistency. Items characteristics",
       subtitle = "Difficulty (blue) and Dicrimination (red)") +
  theme(plot.title = element_text(hjust = .5),
        plot.subtitle = element_text(hjust = .5))
```

```{r}
kable(co1$alpha.drop,
      caption = "Consistency. Subscale statistics when item drop",
      label = 13, digits = 2,
      col.names = alpha_drop_colnames)
```

```{r}
kable(co1$response.freq,
      caption = "Consistency. Non missing response frequency for each item",
      label = 14, digits = 2)
```



#### Utility

```{r}
ut1 <- psych::alpha(
  taia %>% select(all_of(ut_items)),
  cumulative = TRUE,
  title = "Utility Factor",
  check.keys = FALSE
)
```

```{r}
kable(ut1$total,
      caption = "Utility. Subscale statistics", 
      label = 15, digits = 2,
      col.names = total_colnames)
```

```{r}
ut1$item.stats$mean <- ut1$item.stats$mean / 5
kable(ut1$item.stats,
      caption = "Utility. Items statistics",
      label = 16, digits = 2,
      col.names = item_stats_colnames)
```

```{r}
ut1$item.stats %>%
  ggplot(aes(x = row.names(ut1$item.stats))) +
  geom_point(aes(y = mean), color = "darkblue", size = 3) +
  geom_point(aes(y = raw.r), color = "darkred", size = 2) +
  geom_hline(yintercept = 0.1, color = "darkblue") +
  geom_hline(yintercept = 0.9, color = "darkblue") +
  geom_hline(yintercept = 0.25, color = "darkred") +
  geom_hline(yintercept = 0, color = "black") +
  labs(x = "Item", y = "Value",
       title = "Utility. Items characteristics",
       subtitle = "Difficulty (blue) and Dicrimination (red)") +
  theme(plot.title = element_text(hjust = .5),
        plot.subtitle = element_text(hjust = .5))
```

```{r}
kable(ut1$alpha.drop,
      caption = "Utility. Subscale statistics when item drop",
      label = 17, digits = 2,
      col.names = alpha_drop_colnames)
```

```{r}
kable(ut1$response.freq,
      caption = "Utility. Non missing response frequency for each item",
      label = 18, digits = 2)
```



#### Faith

```{r}
fa1 <- psych::alpha(
  taia %>% select(all_of(fa_items)),
  cumulative = TRUE,
  title = "Faith Factor",
  check.keys = FALSE
)
```

```{r}
kable(fa1$total,
      caption = "Faith. Subscale statistics", 
      label = 19, digits = 2,
      col.names = total_colnames)
```

```{r}
fa1$item.stats$mean <- fa1$item.stats$mean / 5
kable(fa1$item.stats,
      caption = "Faith. Items statistics",
      label = 20, digits = 2,
      col.names = item_stats_colnames)
```

```{r}
fa1$item.stats %>%
  ggplot(aes(x = row.names(fa1$item.stats))) +
  geom_point(aes(y = mean), color = "darkblue", size = 3) +
  geom_point(aes(y = raw.r), color = "darkred", size = 2) +
  geom_hline(yintercept = 0.1, color = "darkblue") +
  geom_hline(yintercept = 0.9, color = "darkblue") +
  geom_hline(yintercept = 0.25, color = "darkred") +
  geom_hline(yintercept = 0, color = "black") +
  labs(x = "Item", y = "Value",
       title = "Faith. Items characteristics",
       subtitle = "Difficulty (blue) and Dicrimination (red)") +
  theme(plot.title = element_text(hjust = .5),
        plot.subtitle = element_text(hjust = .5))
```

```{r}
kable(fa1$alpha.drop,
      caption = "Faith. Subscale statistics when item drop",
      label = 21, digits = 2,
      col.names = alpha_drop_colnames)
```

```{r}
kable(fa1$response.freq,
      caption = "Faith. Non missing response frequency for each item",
      label = 22, digits = 2)
```



#### Dependability

```{r}
de1 <- psych::alpha(
  taia %>% select(all_of(de_items)),
  cumulative = TRUE,
  title = "Dependability Factor",
  check.keys = FALSE
)
```

```{r}
kable(de1$total,
      caption = "Dependability. Subscale statistics", 
      label = 23, digits = 2,
      col.names = total_colnames)
```

```{r}
de1$item.stats$mean <- de1$item.stats$mean / 5
kable(de1$item.stats,
      caption = "Dependability. Items statistics",
      label = 24, digits = 2,
      col.names = item_stats_colnames)
```

```{r}
de1$item.stats %>%
  ggplot(aes(x = row.names(de1$item.stats))) +
  geom_point(aes(y = mean), color = "darkblue", size = 3) +
  geom_point(aes(y = raw.r), color = "darkred", size = 2) +
  geom_hline(yintercept = 0.1, color = "darkblue") +
  geom_hline(yintercept = 0.9, color = "darkblue") +
  geom_hline(yintercept = 0.25, color = "darkred") +
  geom_hline(yintercept = 0, color = "black") +
  labs(x = "Item", y = "Value",
       title = "Dependability. Items characteristics",
       subtitle = "Difficulty (blue) and Dicrimination (red)") +
  theme(plot.title = element_text(hjust = .5),
        plot.subtitle = element_text(hjust = .5))
```

```{r}
kable(de1$alpha.drop,
      caption = "Dependability. Subscale statistics when item drop",
      label = 25, digits = 2,
      col.names = alpha_drop_colnames)
```

```{r}
kable(de1$response.freq,
      caption = "Dependability. Non missing response frequency for each item",
      label = 26, digits = 2)
```



#### Understanding

```{r}
un1 <- psych::alpha(
  taia %>% select(all_of(un_items)),
  cumulative = TRUE,
  title = "Understanding Factor",
  check.keys = FALSE
)
```

```{r}
kable(un1$total,
      caption = "Understanding. Subscale statistics", 
      label = 27, digits = 2,
      col.names = total_colnames)
```

```{r}
un1$item.stats$mean <- un1$item.stats$mean / 5
kable(un1$item.stats,
      caption = "Understanding. Items statistics",
      label = 28, digits = 2,
      col.names = item_stats_colnames)
```

```{r}
un1$item.stats %>%
  ggplot(aes(x = row.names(un1$item.stats))) +
  geom_point(aes(y = mean), color = "darkblue", size = 3) +
  geom_point(aes(y = raw.r), color = "darkred", size = 2) +
  geom_hline(yintercept = 0.1, color = "darkblue") +
  geom_hline(yintercept = 0.9, color = "darkblue") +
  geom_hline(yintercept = 0.25, color = "darkred") +
  geom_hline(yintercept = 0, color = "black") +
  labs(x = "Item", y = "Value",
       title = "Understanding. Items characteristics",
       subtitle = "Difficulty (blue) and Dicrimination (red)") +
  theme(plot.title = element_text(hjust = .5),
        plot.subtitle = element_text(hjust = .5))
```

```{r}
kable(un1$alpha.drop,
      caption = "Understanding. Subscale statistics when item drop",
      label = 29, digits = 2,
      col.names = alpha_drop_colnames)
```

```{r}
kable(un1$response.freq,
      caption = "Understanding. Non missing response frequency for each item",
      label = 30, digits = 2)
```

```{r}
omega(taia %>% ungroup() %>% select(all_of(taia_items)),
      nfactors=6, p=.05, poly=FALSE,
      digits=2, title="Omega", sl=TRUE, plot=TRUE, covar=FALSE)
```


```{r}
splitHalf(taia %>% ungroup() %>% select(all_of(taia_items)),
          raw=F, brute=F, n.sample=100, covar=F,
          check.keys=F, key=NULL, use="pairwise")
```

```{r}
guttman(taia %>% ungroup() %>% select(all_of(taia_items)))
```

```{r}
glb.fa(taia %>% ungroup() %>% select(all_of(taia_items)))
```




## Items exclusion

### First step

Excluded items: `co07`, `ut10`, `de04`

Reason: negative discrimination

```{r}
co_items_old <- co_items
co_items[-7] -> co_items
```
```{r}
ut_items_old <- ut_items
ut_items[-10] -> ut_items
```

```{r}
de_items_old <- de_items
de_items[-4] -> de_items
```


### Subscales after first step of exclusion

#### Consistency

```{r}
co2 <- psych::alpha(
  taia %>% select(all_of(co_items)),
  cumulative = TRUE,
  title = "Consistency Factor",
  check.keys = FALSE
)
```

```{r}
kable(co2$total,
      caption = "Consistency. Subscale statistics", 
      label = 11, digits = 2,
      col.names = total_colnames)
```


```{r}
co2$item.stats$mean <- co2$item.stats$mean / 5
kable(co2$item.stats,
      caption = "Consistency. Items statistics",
      label = 12, digits = 2,
      col.names = item_stats_colnames)
```

```{r}
co2$item.stats %>%
  ggplot(aes(x = row.names(co2$item.stats))) +
  geom_point(aes(y = mean), color = "darkblue", size = 3) +
  geom_point(aes(y = raw.r), color = "darkred", size = 2) +
  geom_hline(yintercept = 0.1, color = "darkblue") +
  geom_hline(yintercept = 0.9, color = "darkblue") +
  geom_hline(yintercept = 0.25, color = "darkred") +
  geom_hline(yintercept = 0, color = "black") +
  labs(x = "Item", y = "Value",
       title = "Consistency. Items characteristics",
       subtitle = "Difficulty (blue) and Dicrimination (red)") +
  theme(plot.title = element_text(hjust = .5),
        plot.subtitle = element_text(hjust = .5))
```

```{r}
kable(co2$alpha.drop,
      caption = "Consistency. Subscale statistics when item drop",
      label = 13, digits = 2,
      col.names = alpha_drop_colnames)
```

```{r}
kable(co2$response.freq,
      caption = "Consistency. Non missing response frequency for each item",
      label = 14, digits = 2)
```



#### Utility

```{r}
ut2 <- psych::alpha(
  taia %>% select(all_of(ut_items)),
  cumulative = TRUE,
  title = "Utility Factor",
  check.keys = FALSE
)
```

```{r}
kable(ut2$total,
      caption = "Utility. Subscale statistics", 
      label = 15, digits = 2,
      col.names = total_colnames)
```

```{r}
ut2$item.stats$mean <- ut2$item.stats$mean / 5
kable(ut2$item.stats,
      caption = "Utility. Items statistics",
      label = 16, digits = 2,
      col.names = item_stats_colnames)
```

```{r}
ut2$item.stats %>%
  ggplot(aes(x = row.names(ut2$item.stats))) +
  geom_point(aes(y = mean), color = "darkblue", size = 3) +
  geom_point(aes(y = raw.r), color = "darkred", size = 2) +
  geom_hline(yintercept = 0.1, color = "darkblue") +
  geom_hline(yintercept = 0.9, color = "darkblue") +
  geom_hline(yintercept = 0.25, color = "darkred") +
  geom_hline(yintercept = 0, color = "black") +
  labs(x = "Item", y = "Value",
       title = "Utility. Items characteristics",
       subtitle = "Difficulty (blue) and Dicrimination (red)") +
  theme(plot.title = element_text(hjust = .5),
        plot.subtitle = element_text(hjust = .5))
```

```{r}
kable(ut2$alpha.drop,
      caption = "Utility. Subscale statistics when item drop",
      label = 17, digits = 2,
      col.names = alpha_drop_colnames)
```

```{r}
kable(ut2$response.freq,
      caption = "Utility. Non missing response frequency for each item",
      label = 18, digits = 2)
```



#### Dependability

```{r}
de2 <- psych::alpha(
  taia %>% select(all_of(de_items)),
  cumulative = TRUE,
  title = "Dependability Factor",
  check.keys = FALSE
)
```

```{r}
kable(de2$total,
      caption = "Dependability. Subscale statistics", 
      label = 23, digits = 2,
      col.names = total_colnames)
```

```{r}
de2$item.stats$mean <- de2$item.stats$mean / 5
kable(de2$item.stats,
      caption = "Dependability. Items statistics",
      label = 24, digits = 2,
      col.names = item_stats_colnames)
```

```{r}
de2$item.stats %>%
  ggplot(aes(x = row.names(de2$item.stats))) +
  geom_point(aes(y = mean), color = "darkblue", size = 3) +
  geom_point(aes(y = raw.r), color = "darkred", size = 2) +
  geom_hline(yintercept = 0.1, color = "darkblue") +
  geom_hline(yintercept = 0.9, color = "darkblue") +
  geom_hline(yintercept = 0.25, color = "darkred") +
  geom_hline(yintercept = 0, color = "black") +
  labs(x = "Item", y = "Value",
       title = "Dependability. Items characteristics",
       subtitle = "Difficulty (blue) and Dicrimination (red)") +
  theme(plot.title = element_text(hjust = .5),
        plot.subtitle = element_text(hjust = .5))
```

```{r}
kable(de2$alpha.drop,
      caption = "Dependability. Subscale statistics when item drop",
      label = 25, digits = 2,
      col.names = alpha_drop_colnames)
```

```{r}
kable(de2$response.freq,
      caption = "Dependability. Non missing response frequency for each item",
      label = 26, digits = 2)
```

### Reliability measures

```{r}
omega(taia %>% ungroup() %>% select(all_of(taia_items)),
      nfactors=6, p=.05, poly=FALSE,
      digits=2, title="Omega", sl=TRUE, plot=TRUE, covar=FALSE)
```


```{r}
splitHalf(taia %>% ungroup() %>% select(all_of(taia_items)),
          raw=F, brute=F, n.sample=100, covar=F,
          check.keys=F, key=NULL, use="pairwise")
```

```{r}
guttman(taia %>% ungroup() %>% select(all_of(taia_items)))
```

```{r}
glb.fa(taia %>% ungroup() %>% select(all_of(taia_items)))
```









# Exploratory Factor Analysis

```{r}
taia_items <- c(
  pr_items, co_items, ut_items, fa_items, de_items, un_items
)
```

6 factors, varimax rotation

```{r}
efa_6f_vm <- factanal(taia %>% select(all_of(taia_items)),
                   factors = 6,
                   scores = "regression",
                   rotation = "varimax")
```

```{r}
loadings(efa_6f_vm)
```


```{r}
kable(sort(efa_6f_vm$uniquenesses, decreasing = TRUE), col.names = "U")
```


6 factors, promax rotation

```{r}
efa_6f_pm <- factanal(taia %>% select(all_of(taia_items)),
                   factors = 6,
                   scores = "regression",
                   rotation = "promax")
```

```{r}
loadings(efa_6f_pm)
```

```{r}
kable(
  sort(efa_6f_pm$uniquenesses, decreasing = TRUE),
  col.names = "U")
```


5 factors, varimax rotation

```{r}
efa_5f_vm <- factanal(taia %>% select(all_of(taia_items)),
                   factors = 5,
                   scores = "regression",
                   rotation = "varimax")
```

```{r}
loadings(efa_5f_vm)
```

```{r}
kable(
  sort(efa_5f_vm$uniquenesses, decreasing = TRUE),
  col.names = "U"
)
```

5 factors, promax rotation

```{r}
efa_5f_pm <- factanal(taia %>% select(all_of(taia_items)),
                   factors = 5,
                   scores = "regression",
                   rotation = "promax")
```

```{r}
loadings(efa_5f_pm)
```

```{r}
kable(
  sort(efa_5f_pm$uniquenesses, decreasing = TRUE),
  col.names = "U"
)
```






# Confirmatory Factor Analysis

## Basic model

Model:

```{r}
mdl1 <- "
PR =~ pr01 + pr02 + pr03 + pr04 + pr05 + pr06 + pr07 + pr08 + pr09 + pr10
CO =~ co01 + co02 + co03 + co04 + co05 + co06 + co08 + co09 + co10
UT =~ ut01 + ut02 + ut03 + ut04 + ut05 + ut06 + ut07 + ut08 + ut09 + ut11 + ut12
FA =~ fa01 + fa02 + fa03 + fa04 + fa05 + fa06 + fa07 + fa08 + fa09 + fa10
DE =~ de01 + de02 + de03 + de05 + de06 + de07 + de08 + de09 + de10 + de11
UN =~ un01 + un02 + un03 + un04 + un05 + un06 + un07 + un08 + un09 + un10 + un11 + un12
"
```

CFA model fitting:

```{r}
model1 <- cfa(mdl1, taia %>% select(all_of(taia_items)))
```

```{r}
summary(model1)
```

Fit measures:

```{r}
kable(tibble(
  `Model 1` = c(
    "Chi-Squared",
    "DF",
    "p",
    "GFI",
    "AGFI",
    "CFI",
    "TLI",
    "SRMR",
    "RMSEA"
  ),
  Value = round(fitmeasures(
    model1,
    c(
      "chisq",
      "df",
      "pvalue",
      "gfi",
      "agfi",
      "cfi",
      "tli",
      "srmr",
      "rmsea"
    )
  ), 4)
))
```


Standardized solution:

```{r}
smodel1 <- standardizedsolution(model1)
```

Loadings:

```{r}
kable(
  smodel1 %>%
    filter(op == "=~"),
  col.names = c(
    "Factor",
    "",
    "Item",
    "Loading",
    "SE",
    "z",
    "p",
    "CI lower bound",
    "CI upper bound"
  ),
  digits = 3
)
```


Covariances:

```{r}
kable(
  smodel1 %>% 
    filter(op == "~~" & lhs != rhs),
  col.names = c("Factor", "", "Factor", "Covariance", "SE", "z", "p", "CI lower bound", "CI upper bound"),
  digits = 3
)
```


Residuals:

```{r}
kable(
  smodel1 %>% 
    filter(op == "~~" & lhs == rhs)%>% 
    select(-(2:3)),
  col.names = c("Item", "Residual", "SE", "z", "p", "CI lower bound", "CI upper bound"),
  digits = 3
)
```


Visualization:


```{r layout="l-screen-inset"}
semPaths(model1, "std")
```


## Model with general factor

Model:

```{r}
mdl2 <- "
PR =~ pr01 + pr02 + pr03 + pr04 + pr05 + pr06 + pr07 + pr08 + pr09 + pr10
CO =~ co01 + co02 + co03 + co04 + co05 + co06 + co08 + co09 + co10
UT =~ ut01 + ut02 + ut03 + ut04 + ut05 + ut06 + ut07 + ut08 + ut09 + ut11 + ut12
FA =~ fa01 + fa02 + fa03 + fa04 + fa05 + fa06 + fa07 + fa08 + fa09 + fa10
DE =~ de01 + de02 + de03 + de05 + de06 + de07 + de08 + de09 + de10 + de11
UN =~ un01 + un02 + un03 + un04 + un05 + un06 + un07 + un08 + un09 + un10 + un11 + un12
DigTrust =~ PR + CO + UT + FA + DE + UN
"
```

```{r}
model2 <- cfa(mdl2, taia %>% select(all_of(taia_items)))
```

```{r}
summary(model2)
```

```{r}
kable(tibble(
  `Model 2` = c(
    "Chi-Squared",
    "DF",
    "p",
    "GFI",
    "AGFI",
    "CFI",
    "TLI",
    "SRMR",
    "RMSEA"
  ),
  Value = round(fitmeasures(
    model2,
    c(
      "chisq",
      "df",
      "pvalue",
      "gfi",
      "agfi",
      "cfi",
      "tli",
      "srmr",
      "rmsea"
    )
  ), 4)
))
```


```{r}
semPaths(model2, "std")
```




# Validation

## TAIA total score

```{r}
taia %>% 
  select(id, all_of(taia_items)) %>% 
  pivot_longer(all_of(taia_items),
               names_to = "subscale",
               values_to = "score") %>% 
  mutate(subscale = str_remove_all(subscale, "[:digit:]{2}") %>% toupper()) %>% 
  group_by(id, subscale) %>% 
  summarise(total_score = sum(score)) %>% 
  pivot_wider(id_cols = id,
              names_from = subscale,
              values_from = total_score) %>% 
  full_join(taia) -> taia
```

```{r}
clrs <-
  c("darkred",
    "chocolate3",
    "goldenrod3",
    "darkgreen",
    "darkblue",
    "purple4")
```


## Correlations with General Trust Scale

```{r}
taia %>% 
  pivot_longer(cols = c("PR", "CO", "UT", "FA", "DE", "UN"),
               names_to = "subscale",
               values_to = "score") %>%
  mutate(subscale = factor(subscale, levels = c("PR", "CO", "UT", "FA", "DE", "UN"))) -> taia_l
```

```{r}
taia_l %>% 
  ggplot(aes(score, gt_score, color = subscale)) +
  geom_point(alpha = .3) +
  geom_smooth(method = "lm") +
  facet_wrap(~ subscale) +
  scale_color_manual(values = clrs) +
  guides(color = FALSE) +
  labs(x = "TAIA subscale total score",
       y = "General Trust Scale total score",
       title = "Corelations between General Trust and TAIA subscales") +
  theme(plot.title = element_text(hjust = .5))
```


```{r}
cor.test(taia$PR, taia$gt_score)
```

```{r}
cor.test(taia$CO, taia$gt_score)
```

```{r}
cor.test(taia$UT, taia$gt_score)
```

```{r}
cor.test(taia$FA, taia$gt_score)
```

```{r}
cor.test(taia$DE, taia$gt_score)
```

```{r}
cor.test(taia$UN, taia$gt_score)
```



## Correlations with questions

```{r}
taia_l %>% 
  ggplot(aes(score, n_dighelp, color = subscale)) +
  geom_point(alpha = .3) +
  geom_smooth(method = "lm") +
  facet_wrap(~ subscale) +
  guides(color = FALSE) +
  scale_color_manual(values = clrs) +
  labs(x = "TAIA subscales total score",
       y = "Number of digital helpers",
       title = "Correlation TAIA subscales with number of digital helpers") +
  theme(plot.title = element_text(hjust = .5))
```

```{r}
cor.test(taia$PR, taia$n_dighelp, method = "sp")
```

```{r}
cor.test(taia$CO, taia$n_dighelp, method = "sp")
```

```{r}
cor.test(taia$UT, taia$n_dighelp, method = "sp")
```

```{r}
cor.test(taia$FA, taia$n_dighelp, method = "sp")
```

```{r}
cor.test(taia$DE, taia$n_dighelp, method = "sp")
```

```{r}
cor.test(taia$UN, taia$n_dighelp, method = "sp")
```


```{r}
taia_l %>%
  ggplot(aes(score, e_dighelp, color = subscale)) +
  geom_point(alpha = .3) +
  geom_smooth(method = "lm") +
  facet_wrap(~ subscale) +
  guides(color = FALSE) +
  scale_color_manual(values = clrs) +
  labs(x = "TAIA subscales total score",
       y = "Estimate of dealing with digital helpers experience",
       title = "Correlation TAIA subscales with expirience of dealing with digital helpers") +
  theme(plot.title = element_text(hjust = .5))
```

```{r}
cor.test(taia$PR, taia$e_dighelp)
```

```{r}
cor.test(taia$CO, taia$e_dighelp)
```

```{r}
cor.test(taia$UT, taia$e_dighelp)
```

```{r}
cor.test(taia$FA, taia$e_dighelp)
```

```{r}
cor.test(taia$DE, taia$e_dighelp)
```

```{r}
cor.test(taia$UN, taia$e_dighelp)
```


```{r}
taia_l %>% 
  ggplot(aes(score, n_socnet, color = subscale)) +
  geom_point(alpha = .3) +
  geom_smooth(method = "lm") +
  facet_wrap(~ subscale) +
  guides(color = FALSE) +
  scale_color_manual(values = clrs) +
  labs(x = "TAIA subscales total score",
       y = "Number of social networks and social media",
       title = "Correlation TAIA subscales with number of social networks and social media") +
  theme(plot.title = element_text(hjust = .5))
```

```{r}
cor.test(taia$PR, taia$n_socnet, method = "sp")
```

```{r}
cor.test(taia$CO, taia$n_socnet, method = "sp")
```

```{r}
cor.test(taia$UT, taia$n_socnet, method = "sp")
```

```{r}
cor.test(taia$FA, taia$n_socnet, method = "sp")
```

```{r}
cor.test(taia$DE, taia$n_socnet, method = "sp")
```

```{r}
cor.test(taia$UN, taia$n_socnet, method = "sp")
```

```{r}
taia_l %>% 
  ggplot(aes(score, f_socnet, color = subscale)) +
  geom_point(alpha = .3) +
  geom_smooth(method = "lm") +
  facet_wrap(~ subscale) +
  guides(color = FALSE) +
  scale_color_manual(values = clrs) +
  labs(x = "TAIA subscales total score",
       y = "Frequency of social networks and social media use",
       title = "Correlation TAIA subscales with frequency of social networks and social media use") +
  theme(plot.title = element_text(hjust = .5))
```

```{r}
cor.test(taia$PR, taia$f_socnet)
```

```{r}
cor.test(taia$CO, taia$f_socnet)
```

```{r}
cor.test(taia$UT, taia$f_socnet)
```

```{r}
cor.test(taia$FA, taia$f_socnet)
```

```{r}
cor.test(taia$DE, taia$f_socnet)
```

```{r}
cor.test(taia$UN, taia$f_socnet)
```



```{r}
taia_l %>% 
  ggplot(aes(score, e_socnet, color = subscale)) +
  geom_point(alpha = .3) +
  geom_smooth(method = "lm") +
  facet_wrap(~ subscale) +
  guides(color = FALSE) +
  scale_color_manual(values = clrs) +
  labs(x = "TAIA subscales total score",
       y = "Estimate of dealing with recommender systems experience",
       title = "Correlation TAIA subscales with experience of dealing with recommender systems") +
  theme(plot.title = element_text(hjust = .5))
```


```{r}
cor.test(taia$PR, taia$e_socnet)
```

```{r}
cor.test(taia$CO, taia$e_socnet)
```

```{r}
cor.test(taia$UT, taia$e_socnet)
```

```{r}
cor.test(taia$FA, taia$e_socnet)
```

```{r}
cor.test(taia$DE, taia$e_socnet)
```

```{r}
cor.test(taia$UN, taia$e_socnet)
```





### Self driving cars and education AI

```{r}
taia %>% 
  mutate_at(vars(selfdrexp, selfdrsafe, eduaiexp),
            function(x) ifelse(x < 0, NA, x)) -> taia
```

```{r}
taia %>% 
  pivot_longer(cols = c("PR", "CO", "UT", "FA", "DE", "UN"),
               names_to = "subscale",
               values_to = "score") %>% 
  mutate(subscale = factor(subscale, levels = c("PR", "CO", "UT", "FA", "DE", "UN"))) %>% 
  ggplot(aes(score, selfdrexp, color = subscale)) +
  geom_point(alpha = .3) +
  geom_smooth(method = "lm") +
  facet_wrap(~ subscale) +
  guides(color = FALSE) +
  scale_color_manual(values = clrs) +
  labs(x = "TAIA subscales total score",
       y = "Estimate of selfdriving car experience",
       title = "Correlation TAIA subscales with selfdriving car experience") +
  theme(plot.title = element_text(hjust = .5))
```

```{r}
cor.test(taia$PR, taia$selfdrexp, method = "sp")
```

```{r}
cor.test(taia$CO, taia$selfdrexp, method = "sp")
```

```{r}
cor.test(taia$UT, taia$selfdrexp, method = "sp")
```

```{r}
cor.test(taia$FA, taia$selfdrexp, method = "sp")
```

```{r}
cor.test(taia$DE, taia$selfdrexp, method = "sp")
```

```{r}
cor.test(taia$UN, taia$selfdrexp, method = "sp")
```



```{r}
taia %>% 
  pivot_longer(cols = c("PR", "CO", "UT", "FA", "DE", "UN"),
               names_to = "subscale",
               values_to = "score") %>% 
  mutate(subscale = factor(subscale, levels = c("PR", "CO", "UT", "FA", "DE", "UN"))) %>% 
  ggplot(aes(score, selfdrsafe, color = subscale)) +
  geom_point(alpha = .3) +
  geom_smooth(method = "lm") +
  facet_wrap(~ subscale) +
  guides(color = FALSE) +
  scale_color_manual(values = clrs) +
  labs(x = "TAIA subscales total score",
       y = "Estimate of selfdriving car safe",
       title = "Correlation TAIA subscales with selfdriving car safe") +
  theme(plot.title = element_text(hjust = .5))
```

```{r}
cor.test(taia$PR, taia$selfdrsafe, method = "sp")
```

```{r}
cor.test(taia$CO, taia$selfdrsafe, method = "sp")
```

```{r}
cor.test(taia$UT, taia$selfdrsafe, method = "sp")
```

```{r}
cor.test(taia$FA, taia$selfdrsafe, method = "sp")
```

```{r}
cor.test(taia$DE, taia$selfdrsafe, method = "sp")
```

```{r}
cor.test(taia$UN, taia$selfdrsafe, method = "sp")
```



```{r}
taia %>% 
  pivot_longer(cols = c("PR", "CO", "UT", "FA", "DE", "UN"),
               names_to = "subscale",
               values_to = "score") %>% 
  mutate(subscale = factor(subscale, levels = c("PR", "CO", "UT", "FA", "DE", "UN"))) %>% 
  ggplot(aes(score, eduaiexp, color = subscale)) +
  geom_point(alpha = .3) +
  geom_smooth(method = "lm") +
  facet_wrap(~ subscale) +
  guides(color = FALSE) +
  scale_color_manual(values = clrs) +
  labs(x = "TAIA subscales total score",
       y = "Estimate of dealing with education AI experience",
       title = "Correlation TAIA subscales with experience of dealing with education AI") +
  theme(plot.title = element_text(hjust = .5))
```


```{r}
cor.test(taia$PR, taia$eduaiexp, method = "sp")
```

```{r}
cor.test(taia$CO, taia$eduaiexp, method = "sp")
```

```{r}
cor.test(taia$UT, taia$eduaiexp, method = "sp")
```

```{r}
cor.test(taia$FA, taia$eduaiexp, method = "sp")
```

```{r}
cor.test(taia$DE, taia$eduaiexp, method = "sp")
```

```{r}
cor.test(taia$UN, taia$eduaiexp, method = "sp")
```


